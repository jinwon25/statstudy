## Chapter 04 확률변수와 확률분포<br>-R과 Python을 활용한 기초통계플러스알파-

### 4.1 확률변수와 확률분포

#### 수
- 분류 기준에 따라 여러 가지로 구분할 수 있음

    **상수:** 늘 일정한 수
    - **기지의 상수:** 이미 알려져 있어 변동의 여지가 없는 수
    - **미지의 상수:** 방정식의 해와 같이 조건에 따라 찾아보면 실직선 상의 고정된 자리에 위치하고 있는 수

    **변수:** 변하는 수

#### 4.1.1 확률변수
- 확률에 따라 변하는 수로, 표본공간으로부터 실수값으로의 변환 함수

> $X : Ω -> R$
>
> Ω: 표본공간<br>
> R: 실수집합<br>
> X: 확률변수

- 통계학에서는 확률변수를 영문 대문자로 표현하며($X, Y, Z, X_1, X_2, ...$), 확률변수의 관측값을 대응하는 영문 소문자로 표현($x, y, z, x_1, x_2, ...$)
- 이산형 확률변수와 연속형 확률변수로 구분

#### 4.1.2 확률분포
- 확률변수가 특정한 값(이산형) 또는 특정한 구간(연속형)에 속할 가능성에 대한 확률을 표 또는 수식 등으로 요약하여 표현한 것

- 확률분포는 확률로 직접 표현, 그래프로 표현, 확률분포표로 표현, 확률함수로 표현하는 등 다양한 방법이 있음
    - **확률함수:** 확률분포를 수식으로 표현한 것
- 통계학에서는 확률분포를 수식으로 표현할 수 있는 경우에는 확률함수로 표현하는 것을 권장 -> 수식으로 표현하였을 때, 기댓값, 분산 등 특성치를 계산하는데 더 용이하기 때문
---
### 4.2 이산형 확률변수와 확률질량함수

#### 이산형 확률변수
- 확률변수가 가질 수 있는 값(발생 가능 값)이 셀 수 있는 확률변수
- 각 이산점에서 0이 아닌 확률을 갖는 확률변수
- 가질 수 있는 값의 수가 자연수와 일대일로 대응되는 확률변수
- 이산형 확률변수 X가 발생 가능한 값 가운데 특정한 값 x를 가질 확률은 P(X = x)라고 표현

#### 확률질량함수
- 이산형 확률변수 X의 각 이산점(발생 가능점)에 대한 확률의 크기를 표현한 함수
- 확률질량함수(pmf) P(X = x)의 조건(특성)<br>
(1) $0 ≤ P(X = x) ≤ 1, ∀x$<br>
(2) $\displaystyle\sum_{x}{P(X = x) = 1}$
---
### 4.3 연속형 확률변수와 확률밀도함수

#### 연속형 확률변수
- 확률변수가 가질 수 있는 값이 특정한 실수 구간으로 주어지는 확률변수
- 실수의 조밀성 때문에 한 점에서의 확률은 0이고, 특정 구간에 속할 가능성을 확률로 표현

#### 확률밀도함수
- 이산형 확률변수의 확률질량함수와 유사하게 연속형 확률변수가 특정한 구간에 속할 확률을 구하는데 사용
- 연속형 확률변수 X의 확률밀도함수(pdf)는 f(x)라고 표현
- 확률밀도함수(pdf) f(x)의 조건(특성)<br>
(1) 모든 x값에 대하여 $f(x) ≥ 0, ∀x$<br>
(2) X의 모든 가능한 값에 대한 확률: $\int_{-\infty}^{\infty} f(x)dx = 1$
(3) X가 구간 (a, b)에 속할 확률: $P(a ≤ X ≤ b) = \int_{a}^{b} f(x)dx$
---
### 4.4 누적분포함수

#### 누적분포함수
- 확률변수가 특정값 이하를 가질 확률을 의미
- 확률변수 X의 누적분포함수는 F(x)로 표현 (즉, $F(x) = P(X ≤ x)$
- 연속형 확률변수에서는 한 점의 확률은 0이기 때문에 특정한 점의 포함 여부가 누적확률의 계산에 영향을 미치지 않지만, 이산형 확률변수에서는 특정한 점의 포함 여부가 누적확률의 계산에 영향을 미치기 때문에 주의

- **누적분포함수(CDF)** F(x)
    - **확률변수 X가 이산형:** $F(x) = P(X \leq x) = \displaystyle\sum_{t \leq x} P(X = t)$<br>
    *여기서 P(X = x)는 X의 확률질량함수(pmf)*<br>
    - **확률변수 X가 연속형:** $F(x) = P(X \leq x) = \int_{-\infty}^{x} f(t)dt$<br>
    *여기서 f(x)는 X의 확률밀도함수(pdf)*

- **누적분포함수(CDF) F(x)의 특성**<br>
(1) $F(\infty) = P(X \leq \infty) = 1$<br>
(2) $F(-\infty) = P(X \leq -\infty) = 0$<br>
(3) 모든 $x_1 < x_2$에 대하여 $F(x_1) = P(X \leq x_1) \leq P(X \leq x_2) = F(x_2)$: **비감소함수**<br>
(4) $F(x) = \displaystyle\lim_{\epsilon \to 0} F(x + \epsilon), \forall \epsilon > 0$: **우측연속**

#### 4.4.1 이산형 확률변수의 누적분포함수
- 이산형 확률변수의 누적분포함수는 계단함수(step function)의 형태이며, 발생 가능한 이산점에서 확률의 크기가 계단의 높이
- 계단의 높이<br>
$P(X = 0) = F(0)$<br>
$P(X = 1) = F(1) - F(0)$<br>
$P(X = 2) = F(2) - F(1)$<br>
$P(X = 3) = F(3) - F(2)$<br>

#### 4.4.2 연속형 확률변수의 누적분포함수
- 연속형 확률변수 X의 확률밀도함수가 다음과 같을 때,<br>
$f(x) = \begin{cases} 1, & 0 \leq x \leq 1 \\0, & \text{다른 곳에서}\end{cases}$
- 연속형 확률변수 \(X\)의 누적분포함수 \(F(x)\)<br>
(i) $x < 0; F(x) = P(X \leq x) = \int_{-\infty}^{x} 0 dt = 0$<br>
(ii) $0 \leq x < 1; F(x) = P(X \leq x) = \int_{-\infty}^{0} 0 dt + \int_{0}^{x} 1 dt = \left[t \right]_0^x = x$<br>
(iii) $x \geq 1; F(x) = P(X \leq x) = \int_{-\infty}^{0} 0 dt + \int_{0}^{1} 1 dt + \int_{1}^{\infty} 0 dt = \left[ t \right]_0^1 = 1$<br>
$F(x) = \begin{cases} 0, & x < 0 \\x, & 0 \leq x \leq 1 \\1, & x \geq 1\end{cases}$
- 연속형 확률변수의 확률밀도함수를 적분하여 누적분포함수를 구하므로<br>
$F(x) = \int_{-\infty}^{x} f(t) dt$
- 누적분포함수를 미분하면 확률밀도함수를 구할 수 있음<br>
$\frac{d}{dx} F(x) = f(x)$
---
### 4.5 두 확률변수의 결합분포
**결합확률분포:** 두 개 이상의 확률변수에 대한 분포를 동시에 나타내는 것
- 두 확률변수가 이산형일때는 결합 확률질량함수(jpmf)라 하고, 연속형일때는 결합 확률밀도함수(jpdf)라 함

#### 4.5.1 두 확률변수의 결합분포함수
(1) **이산형 확률변수 X, Y**
- **결합 확률질량함수(jpmf):** $P(X = x, Y = y)$
- 모든 x, y에 대하여 $P(X = x, Y = y)$
- $\displaystyle\sum_{x} \displaystyle\sum_{y} P(X = x, Y = y) = 1$<br>

(2) **연속형 확률변수 X, Y**
- **결합 확률밀도함수(jpdf):** $f_{X, Y}(x, y)$
- 모든 x, y에 대하여 $f_{X, Y}(x, y) \geq 0$
- $\int_{-\infty}^{\infty} \int_{-\infty}^{\infty} f_{X,Y}(x, y) \, dx \, dy = 1$
- $P(a \leq X \leq b, c \leq Y \leq d) = \int_{c}^{d} \int_{a}^{b} f_{X,Y}(x, y) \, dx \, dy$

#### 4.5.2 주변확률분포
- **주변확률분포:** 결합확률분포에서 각 확률변수에 대한 분포를 나타내는 것

(1) **이산형 확률변수 X, Y; 결합 확률질량함수:**
- **X의 주변 확률질량함수:** $P(X = x) = \displaystyle\sum_y P(X = x, Y = y)$
- **Y의 주변 확률질량함수:** $P(Y = y) = \displaystyle\sum_x P(X = x, Y = y)$

(2) **연속형 확률변수 X, Y; 결합 확률밀도함수:** 
- **X의 주변 확률밀도함수:** $f_X(x) = \int_{-\infty}^{\infty} f_{X,Y}(x, y) \, dy$
- **Y의 주변 확률밀도함수:** $f_Y(y) = \int_{-\infty}^{\infty} f_{X,Y}(x, y) \, dx$
---
### 4.6 두 확률변수의 독립

#### 사건의 독립
- 두 사건 A, B가 통계적으로 독립 <=> $P(A ∩ B) = P(A)P(B)$

#### 확률변수의 독립
- 두 이산형 확률변수 X, Y가 통계적으로 독립 <=> $P(X = x, Y = y) = P(X = x)P(Y = y), ∀_{x, y}$
- 두 연속형 확률변수 X, Y가 통계적으로 독립 <=> $f_{X, Y}(x, y) = f_X(x)f_Y(y)$
---
### 4.7 평균, 분산, 공분산, 상관계수

#### 4.7.1 평균
- 분포의 무게중심
- 기댓값이라고도 함
- 통계학에서 평균(모평균)은 그리스어 소문자 𝜇(영어 소문자 m에 해당)로 표기
- 확률변수 X의 평균 𝜇는 E(X)라고 표현
- 평균은 확률변수의 값들이 가질 수 있는 확률(이산형) 또는 확률변수의 값이 속할 수 있는 구간의 확률(연속형)을 가중치로 적용하여 계산하는 가중 평균의 개념
- 확률변수의 형태에 따라 다음과 같이 정의<br>
$\mu = E(X) = \begin{cases} \displaystyle\sum_x x P(X = x), & \text{이산형} \\ \int_{-\infty}^{\infty} x f(x) \, dx, & \text{연속형}\end{cases}$

##### 확률변수의 함수의 평균(기댓값)
- 확률변수 X의 임의의 함수를 g(X)라 하면 E[g(X)]는 다음과 같음<br>
$E[g(X)] = \begin{cases} \displaystyle\sum_x g(x) P(X = x), & \text{이산형} \\ \int_{-\infty}^{\infty} g(x) f(x) \, dx, & \text{연속형}\end{cases}$
- 두 확률변수 X, Y의 임의의 함수를 g(X, Y)라 하면, E[g(X, Y)]는 다음과 같음<br>
$E[g(X, Y)] = \begin{cases} \displaystyle\sum_x \displaystyle\sum_y g(x, y) P(X = x, Y = y), & \text{이산형} \\ \int_{-\infty}^{\infty} \int_{-\infty}^{\infty} g(x, y) f(x, y) \, dx \, dy, &\text{연속형}\end{cases}$

##### 평균(기댓값)의 특성
- X, Y를 확률변수, a, b, c를 상수라고 할 때, 다음이 성립함

    (1) $E(a) = a$<br>
    (2) $E(aX + b) = aE(X) + b$<br>
    (3) $E(aX + bY + c) = aE(X) + bE(Y) + c$

#### 4.7.2 분산
- 확률변수가 평균을 중심으로 퍼진 정도를 나타내는 척도
- 분산이 크다는 것은 확률변수의 관찰 가능한 값들이 평균을 중심으로 넓게 분포되어 있음을 의미하며, 분산이 작다는 것은 평균을 중심으로 조밀하게 분포되어 있음을 의미
- 두 개 이상의 확률변수가 있을 때 분산의 값이 큰 확률변수가 분산이 작은 확률변수에 비해 상대적으로 넓게 분포한다는 것을 의미
- 분산 $Var(X)$은 확률변수 𝑋의 평균(기댓값)을 $𝜇 = E(X)$라고 할 때, $(X − 𝜇)^2$의 기댓값으로 다음과 같이 정의하며 $𝜎^2$라고 표기함<br>
$𝜎^2 = Var(X) = E[(X - 𝜇)^2]$
- 확률변수의 형태에 따라 다음과 같이 정의할 수 있음<br>
$Var(X) = E[(X - 𝜇)^2] = \begin{cases} \displaystyle\sum_x (x - 𝜇)^2 P(X = x), & \text{이산형} \\ \int_{-\infty}^{\infty} (x - 𝜇)^2 f(x) \, dx, &\text{연속형}\end{cases}$
- 분산을 구할 때는 다음과 같은 분산의 변형 공식이 자주 이용됨<br>
$Var(X) = E \left[ (X - \mu)^2 \right] = E \left( X^2 - 2\mu X + \mu^2 \right)$<br>
&emsp;&emsp;&emsp;&emsp;&nbsp;$= E(X^2) - 2\mu E(X) + \mu^2 = E(X^2) - 2u^2 + u^2$<br>
&emsp;&emsp;&emsp;&emsp;&nbsp;$= E(X^2) - u^2$<br>
&emsp;&emsp;&emsp;&emsp;&nbsp;$= E(X^2) - \left[ E(X) \right]^2$
- 표준편차: 분산의 양의 제곱근 𝜎<br>
$\sigma = \sqrt{Var(X)}$

#### 4.7.3 공분산과 상관계수

##### 공분산
- 두 개의 확률변수 사이에 어떤 통계적 관계가 있는지 설명하고자 할 때 사용
- 두 확률변수 X, Y의 평균을 $𝜇_X=E(X), 𝜇_Y = E(Y)$라 할 때, 두 편차 $X − 𝜇_X, Y − 𝜇_Y$의 곱의 기댓값으로 정의되며 Cov(X, Y)로 표현<br>
$Cov(X, Y) = E[(X − 𝜇_X)(Y − 𝜇_Y)]$
- 공분산은 그 부호가 중요한 의미를 갖는데, 두 변수의 관계가 양의 관계인지, 음의 관계인지에 대한 방향성을 파악할 수 있는 척도로 해석할 수 있음
- 분산과 마찬가지로, 공분산은 변형 공식을 사용하여 구하는 것이 편리함<br>
$Cov(X, Y) = E \left[ (X - \mu_X)(Y - \mu_Y) \right] = E \left( X^2 - 2\mu X + \mu^2 \right)$<br>
&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;$= E(XY - \mu_XY - \mu_YX + \mu_X\mu_Y)$<br>
&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;$= E(XY) - \mu_XE(Y) - \mu_YE(X) + \mu_X\mu_Y$<br>
&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;$= E(XY) - \mu_X\mu_Y - \mu_Y\mu_X + \mu_X\mu_Y$<br>
&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;$= E(XY) - \mu_X\mu_Y$<br>
&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;$= E(XY) - E(X)E(Y)$
- E(XY)는 확률변수의 형태에 따라 다음과 같이 계산함<br>
$E(XY) = \begin{cases} \displaystyle\sum_x \displaystyle\sum_y xyP(X = x, Y = y), & \text{이산형} \\ \int_{-\infty}^{\infty} \int_{-\infty}^{\infty} xyf(x, y) \, dxdy, &\text{연속형}\end{cases}$

##### 두 확률변수의 독립성과 공분산
- 두 이산형 확률변수 X와 Y가 서로 독립이면 E(XY) = E(X)E(Y)이므로 공분산은 0임<br>
Cov(XY) = E(XY) - E(X)E(Y) = 0
- 그러나, 그 역은 성립하지 않는 것에 주의!<br>
즉, 서로 독립인 두 확률변수의 공분산은 ‘0’ 이지만, 공분산이 ‘0’ 이라고 해서 두 확률변수가 항상 서로 독립이라고 말할 수 없음

##### 상관계수
- 두 확률변수 사이의 선형 관계의 정도를 나타냄
- 두 확률변수 X, Y의 상관계수는 다음과 같이 정의되며 𝜌(X, Y) 또는 Corr(X, Y)로 표기
$𝜌(𝑋,𝑌) = Corr(X, Y) = \frac{Cov(X, Y)}{\sqrt{Var(X)\sqrt{Var(Y)}}} = \frac{Cov(X, Y)}{\sigma_X\sigma_Y}$
- 상관계수의 부호는 공분산의 부호와 동일
- 상관계수는 표준화된 두 확률변수의 공분산이라고 설명할 수 있음
$𝜌(𝑋,𝑌) = \frac{Cov(X, Y)}{\sigma_X\sigma_Y} = \frac{E[(X - \mu_X)(Y - \mu_Y)]}{\sigma_X\sigma_Y} = E[(\frac{X - \mu_X}{\sigma_X})(\frac{Y - \mu_Y}{\sigma_Y})]$
- 상관계수의 범위와 의미
    - 상관계수의 범위: $−1 ≤ 𝜌(𝑋,𝑌) ≤ 1$
    - 양의 (선형) 상관관계: $𝜌(𝑋,𝑌) → +1$
    - 음의 (선형) 상관관계: $𝜌(𝑋,𝑌) → -1$
    - 무상관[독립과는 다른 개념]: $𝜌(𝑋,𝑌) → 0$

##### 분산, 공분산, 상관계수의 특성
- X, Y를 확률변수, a, b, c, d를 상수라고 할 때, 다음이 성립함

    (1) $Var(aX + b) = a^2Var(X)$<br>
    (2) $Var(X ± Y) = Var(X) + Var(Y) ± 2Cov(X, Y)$<br>
    (3) $Var(X ± Y) = Var(X) + Var(Y)$ → X, Y는 독립<br>
    (4) $Cov(ax + b, cY + d) = acCov(X, Y)$<br>
    (5) $Corr(aX + b, cY + d) = \begin{cases} Corr(X, Y), & \text{if ac > 0} \\ -Corr(X,Y), &\text{if ac < 0}\end{cases}$
